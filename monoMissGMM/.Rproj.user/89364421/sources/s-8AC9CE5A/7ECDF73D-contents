X = matrix(rnorm(12), nrow = 4)
S = t(X) %*% X
chol_S = t(chol(S))
chol_S
t(chol(S[-3,-3]))

y = rnorm(3)

solve(chol_S, y)
solve(t(chol_S), y)

chol_S
chol_lowRankUpdate(X, sqrt(2) * chol_S, rep(1, nrow(X)), FALSE)
